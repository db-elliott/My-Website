[
  {
    "path": "posts/2022-03-14-time-series/",
    "title": "A Time Series Visualization for Willamette Falls Fish Ladder",
    "description": "Portfolio",
    "author": [
      {
        "name": "Deanna Elliott",
        "url": {}
      }
    ],
    "date": "2022-03-14",
    "categories": [],
    "contents": "\r\n\r\n\r\ncode\r\n\r\nknitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)\r\n\r\nlibrary(bslib)\r\nlibrary(tidyverse)\r\nlibrary(here)\r\nlibrary(lubridate)\r\nlibrary(tsibble)\r\nlibrary(feasts)\r\nlibrary(slider)\r\n\r\n\r\n\r\nOverview\r\nThis report explores the timing of adult fish passage through the Willamette Falls fish ladder on the Willamette River in Oregon. We focus on three species: coho salmon, jack coho samon, and steelhead trout. Time series data from the Columbia River Data Access in Real Time project is used to create visualizations for daily counts, seasonality trends, and annual counts of each species for the years 2001-2010.\r\n\r\nData Source: Columbia River DART (Data Access in Real Time), 2010. Courtesy of U.S. Army Corps of Engineers, NWD and Chelan, Douglas, and Grant County PUDs, Yakima Klickitat Fisheries Project, Colville Tribes Fish & Wildlife (OBMEP), Oregon Department of Fish & Wildlife, Washington Department of Fish & Wildlife.\r\n\r\nDaily Time Series\r\n\r\n\r\ncode\r\n\r\n#read in data\r\n\r\nfish_data <- read_csv(here(\"data\", \"willamette_fish_passage.csv\")) %>% \r\n  janitor::clean_names()\r\n\r\nfish_ts <- fish_data %>% \r\n  mutate(date = lubridate::mdy(date)) %>% \r\n  as_tsibble(key = NULL, index = date) %>% \r\n  pivot_longer(!c(project, date, temp_c), names_to = \"species\",\r\n               values_to = \"count\") %>% \r\n  select(date, species, count) %>% \r\n  filter(species %in% c(\"coho\", \"jack_coho\", \"steelhead\")) %>% \r\n    mutate(species = case_when(\r\n    species == \"coho\" ~ \"Coho\",\r\n    species == \"jack_coho\" ~ \"Jack Coho\",\r\n    species == \"steelhead\" ~ \"Steelhead\"))\r\n\r\nfish_ts[is.na(fish_ts)] <- 0\r\n\r\n\r\n\r\n\r\n\r\ncode\r\n\r\nfish_daily <- fish_ts %>% \r\n  group_by(species)\r\n\r\nggplot(data = fish_daily,\r\n       aes(x = date, y = count)) + \r\n  geom_line(aes(color = species)) +\r\n  scale_color_manual(values = c(\"firebrick\", \"green\", \"steelblue\")) +\r\n  labs(x = \"Date\", y = \"Passage Count\",\r\n       color = \"Species\") +\r\n  theme_minimal() \r\n\r\n\r\n\r\n\r\nFigure 1. Daily passage counts. Counts for three species of fish–Coho, Jack Coho, and Steelhead–passing through the Willamette Falls fish ladder are shown daily for the years 2001-2010.\r\n\r\nTake-Aways:\r\nSteelhead counts are generally the highest of the three species.\r\nThere seems to be a seasonal pattern, as more pass through the ladder at certain times of year, but there does not seem to be an overall trend to the actual number that do so.\r\n\r\nCoho counts usually fall between steelhead and jack coho, excepting a few points, mainly two huge spikes in 2010.\r\nJack coho counts are generally the lowest of the three species.\r\n\r\nSeasonplots\r\n\r\n\r\ncode\r\n\r\nfish_month <- fish_ts %>% \r\n  group_by(species) %>% \r\n  index_by(yr_mo = ~ yearmonth(.)) %>% \r\n  summarize(monthly_passage = sum(count, na.rm = TRUE))\r\n\r\nfish_month %>% \r\n  gg_season(y = monthly_passage,\r\n            pal = (viridis::turbo(10))) +\r\n  geom_line(size = 1) +\r\n  theme_minimal() +\r\n  labs(x = \"Month\", y = \"Passage Count\")\r\n\r\n\r\n\r\n\r\nFigure 2. Monthly Average Passage. Average counts for three species of fish–Coho, Jack Coho, and Steelhead–passing through the Willamette Falls fish ladder are shown monthly for the years 2001-2010.\r\n\r\nTake-Aways:\r\nCoho and jack coho have similar seasonality, with passage occurring from the end of summer to the beginning of winter (concentrated in fall).\r\nTheir peaks of activity generally look to be from September to October.\r\n\r\nSteelhead have a much broader stretch of activity, from January to June (midwinter to midsummer).\r\nTheir peak of activity generally looks to be from May to June.\r\n\r\n2009 and 2010 were unusually productive years for coho salmon.\r\n\r\nAnnual Counts by Species\r\n\r\n\r\ncode\r\n\r\nfish_annual <- fish_ts %>% \r\n  group_by(species) %>% \r\n  index_by(yearly = ~year(.)) %>% \r\n  summarize(annual_passage = sum(count, na.rm = TRUE))\r\n\r\nggplot(data = fish_annual,\r\n       aes(x = yearly, y = annual_passage)) + \r\n  geom_line(aes(color = species), size = 1) +\r\n  scale_x_continuous(breaks = seq(2001, 2010, 2)) +\r\n  theme_minimal() +\r\n  scale_color_manual(values = c(\"firebrick\", \"green\", \"steelblue\")) +\r\n  labs(x = \"Year\", y = \"Annual Passage Count\", color = \"Species\")\r\n\r\n\r\n\r\n\r\nFigure 3. Annual Passage Count. Annual counts for three species of fish–Coho, Jack Coho, and Steelhead–passing through the Willamette Falls fish ladder are shown for the years 2001-2010.\r\n\r\nTake-Aways:\r\nSteelhead counts are generally much higher than either of the other two species, but the actual number of fish passing through is rather unpredictable year-to-year.\r\nCoho counts are relatively stable until they hit a massive peak in the later years of the dataset.\r\nJack coho counts are very low and stay consistent over the life of the data.\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-03-14-time-series/time-series_files/figure-html5/unnamed-chunk-2-1.png",
    "last_modified": "2022-03-14T16:46:40-07:00",
    "input_file": "time-series.knit.md"
  }
]
